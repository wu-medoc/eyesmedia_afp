<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1, user-scalable=no">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../js/vendor/bs4/css/bootstrap.min.css">
    <!-- vendor css -->
    <link rel="stylesheet" href="../js/vendor/jquery-editable-select-master/dist/jquery-editable-select.min.css">
    <link rel="stylesheet" href="../js/vendor/swiper/css/swiper.min.css">
    <!-- fontawesome css -->
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/fontawesome.css">
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/brands.css">
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/solid.css">
    <!-- custom css -->
    <link rel="stylesheet" href="../dist/style/css.min.css">
    <link rel="stylesheet" href="../dist/style/global.min.css">
    <link rel="stylesheet" href="../dist/style/index.min.css">
    <link rel="stylesheet" href="../dist/style/shopping-index.min.css">
    <link rel="stylesheet" href="../dist/style/animate.min.css">
    <title>eyemedia - afp</title>
</head>

<body>
    <div class="wrap container">
    <header class="fixed-top container">
        <!-- header top -->
        <div class="header-secondary linebt-row">
            <div class="row">
                <div class="col-3">
                    <div class="close-btn">
                         <button type="button" class="btn" onclick="history.back();" data-toggle="tooltip" data-placement="bottom" title="回上一頁">
                            <i class="material-icons">&#xE314;</i>
                        </button>
                    </div>
                </div>
                <div class="col-6 text-center">
                    <div class="title-name">購物車</div>
                </div>
                <div class="col-3 text-right">
                    <div class="top-item climate"> 
                        <img src="../img/shopping/icon_chat.svg"  data-toggle="tooltip" data-placement="bottom" title="客服">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>        
        <div class="header-42"></div>     
        <div class="shopping-cartlist">
            <ul class="list-unstyled w-100">
                <li class="flex-inline-between center-v">
                    <div class="checkbox checkbox-primary w-50 p-1">
                        <input id="checkedall" type="checkbox" class="store-chk">
                        <label for="checkedall">
                            選擇全部
                        </label>
                    </div>
                    <div class="w-50 text-right p-1">
                         <button type="button" class="btn modifybtn text-info" value="store0">
                            編輯全部
                        </button>
                    </div>
                </li>
                <form id="store1" class="product">
                <ul class="store1ul">
                    <li class="linebt-row10"></li>
                    <li class="flex-inline-between">      
                        <div class="store-title center-v p-1">                                                
                            <div class="checkbox checkbox-primary">
                                <input id="store01-all" type="checkbox" class="checkedall store-chk">
                                <label for="store01-all">
                                    <img src="../img/shopping/icon_store.svg">昇恆昌免稅購物網站 
                                </label>
                            </div>         
                        </div>                
                        <div class="text-right p-1">
                             <button type="button" class="btn text-info modifybtn" value="store1">
                                編輯
                            </button>
                        </div>
                    </li>
                    <li>      
                        <div class="row">                
                            <div class="col-9 col-lg-11"> 
                                <div class="products-sitem d-flex align-items-start bd-highlight">
                                    <div class="sitem-checkbox">
                                        <div class="checkbox checkbox-primary">
                                            <input id="products001" type="checkbox" class="checkedall store01-all"><label for="products001" class="p-0"></label>  
                                        </div>  
                                    </div>
                                    <div class="sitem-img bd-highlight py-1">
                                        <div class="rwdimg" style="background-image: url('../img/shopping/products/p00001.jpg');"></div>
                                    </div>
                                    <div class="sitem-title bd-highlight py-1">
                                        <p class="txt-line-clamp1">Apple iPhone XS 256GB Apple iPhone XS 256GB</p> 
                                        <small class="txt-line-clamp1">規格：香檳金</small> 
                                        <div class="products-quantity">
                                            <div class="d-flex number-spinner">
                                                <div class="input-group-btn data-dwn">
                                                      <button type="button" class="btn btn-default btn-outline-secondary" data-dir="dwn"><i class="fas fa-minus"></i></button>
                                                </div>
                                                <div><input type="number" class="form-control text-center product-quantity" value="1" min="0" max="3"  required="required"></div>
                                                <div class="input-group-btn data-up">
                                                      <button type="button" class="btn btn-default btn-outline-info" data-dir="up"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  
                            </div>                    
                            <div class=" col-3 col-lg-1 text-right">
                                  <button type="button" class="btn products-delbtn" value="store1">刪除</button>
                                <div class="store01-all price-asking" value="30320">$30,320 </div> 
                            </div>  
                        </div>                    
                    </li>
                    <li>      
                        <div class="row">                
                            <div class="col-9 col-lg-11"> 
                                <div class="products-sitem d-flex align-items-start bd-highlight">
                                    <div class="sitem-checkbox">
                                        <div class="checkbox checkbox-primary">
                                            <input id="products002" type="checkbox" class="checkedall store01-all"><label for="products002" class="p-0"></label>  
                                        </div>  
                                    </div>
                                    <div class="sitem-img bd-highlight py-1">
                                        <div class="rwdimg" style="background-image: url('../img/shopping/products/p00002.jpg');"></div>
                                    </div>
                                    <div class="sitem-title bd-highlight py-1">
                                        <p class="txt-line-clamp1">Apple iPhone XS 128GB Apple iPhone XS 128GB</p> 
                                        <small class="txt-line-clamp1">規格：黑色</small> 
                                        <div class="products-quantity">
                                            <div class="d-flex number-spinner">
                                                <div class="input-group-btn data-dwn">
                                                      <button type="button" class="btn btn-default btn-outline-secondary" data-dir="dwn"><i class="fas fa-minus"></i></button>
                                                </div>
                                                <div><input type="number" class="form-control text-center product-quantity" value="1" min="0" max="3"  required="required"></div>
                                                <div class="input-group-btn data-up">
                                                      <button type="button" class="btn btn-default btn-outline-info" data-dir="up"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  
                            </div>                    
                            <div class=" col-3 col-lg-1 text-right">
                                  <button type="button" class="btn products-delbtn" value="store1">刪除</button>
                                <div class="store01-all price-asking" value="27320">$27,320 </div> 
                            </div>  
                        </div>                    
                    </li>
                </ul>
                </form>
                <form id="store2" class="product">
                <ul class="store2ul">
                    <li class="linebt-row10"></li>
                    <li class="flex-inline-between">      
                        <div class="store-title center-v p-1">                                                
                            <div class="checkbox checkbox-primary">
                                <input id="store02-all" type="checkbox" class="checkedall store-chk">
                                <label for="store02-all">
                                    <img src="../img/shopping/icon_store.svg">新光三越線上商城 
                                </label>
                            </div>         
                        </div>                
                        <div class="text-right p-1">
                             <button type="button" class="btn text-info modifybtn" value="store2">
                                編輯
                            </button>
                        </div>
                    </li>
                    <li>      
                        <div class="row">                
                            <div class="col-9 col-lg-11"> 
                                <div class="products-sitem d-flex align-items-start bd-highlight">
                                    <div class="sitem-checkbox">
                                        <div class="checkbox checkbox-primary">
                                            <input id="products003" type="checkbox" class="checkedall store02-all"><label for="products003" class="p-0"></label>  
                                        </div>  
                                    </div>
                                    <div class="sitem-img bd-highlight py-1">
                                        <div class="rwdimg" style="background-image: url('../img/shopping/products/p00001.jpg');"></div>
                                    </div>
                                    <div class="sitem-title bd-highlight py-1">
                                        <p class="txt-line-clamp1">Apple iPhone XS 256GB Apple iPhone XS 256GB</p> 
                                        <small class="txt-line-clamp1">規格：香檳金</small> 
                                        <div class="products-quantity">
                                            <div class="d-flex number-spinner">
                                                <div class="input-group-btn data-dwn">
                                                      <button type="button" class="btn btn-default btn-outline-secondary" data-dir="dwn"><i class="fas fa-minus"></i></button>
                                                </div>
                                                <div><input type="number" class="form-control text-center product-quantity" value="1" min="0" max="3"  required="required"></div>
                                                <div class="input-group-btn data-up">
                                                      <button type="button" class="btn btn-default btn-outline-info" data-dir="up"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  
                            </div>                    
                            <div class=" col-3 col-lg-1 text-right">
                                  <button type="button" class="btn products-delbtn" value="store2">刪除</button>
                                <div class="store02-all price-asking" value="30320">$30,320 </div> 
                            </div>  
                        </div>                    
                    </li>
                    <li>      
                        <div class="row">                
                            <div class="col-9 col-lg-11"> 
                                <div class="products-sitem d-flex align-items-start bd-highlight">
                                    <div class="sitem-checkbox">
                                        <div class="checkbox checkbox-primary">
                                            <input id="products004" type="checkbox" class="checkedall store02-all"><label for="products004" class="p-0"></label>  
                                        </div>  
                                    </div>
                                    <div class="sitem-img bd-highlight py-1">
                                        <div class="rwdimg" style="background-image: url('../img/shopping/products/p00002.jpg');"></div>
                                    </div>
                                    <div class="sitem-title bd-highlight py-1">
                                        <p class="txt-line-clamp1">Apple iPhone XS 128GB Apple iPhone XS 128GB</p> 
                                        <small class="txt-line-clamp1">規格：黑色</small> 
                                        <div class="products-quantity">
                                            <div class="d-flex number-spinner">
                                                <div class="input-group-btn data-dwn">
                                                      <button type="button" class="btn btn-default btn-outline-secondary" data-dir="dwn"><i class="fas fa-minus"></i></button>
                                                </div>
                                                <div><input type="number" class="form-control text-center product-quantity" value="1" min="0" max="3"  required="required"></div>
                                                <div class="input-group-btn data-up">
                                                      <button type="button" class="btn btn-default btn-outline-info" data-dir="up"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  
                            </div>                    
                            <div class=" col-3 col-lg-1 text-right">
                                  <button type="button" class="btn products-delbtn" value="store2">刪除</button>
                                <div class="store02-all price-asking" value="27320">$27,320 </div> 
                            </div>  
                        </div>                    
                    </li>  
                    <li>      
                        <div class="row">                
                            <div class="col-9 col-lg-11"> 
                                <div class="products-sitem d-flex align-items-start bd-highlight">
                                    <div class="sitem-checkbox">
                                        <div class="checkbox checkbox-primary">
                                            <input id="products005" type="checkbox" class="checkedall store02-all"><label for="products005" class="p-0"></label>  
                                        </div>  
                                    </div>
                                    <div class="sitem-img bd-highlight py-1">
                                        <div class="rwdimg" style="background-image: url('../img/shopping/products/p00002.jpg');"></div>
                                    </div>
                                    <div class="sitem-title bd-highlight py-1">
                                        <p class="txt-line-clamp1">Apple iPhone XS 128GB Apple iPhone XS 128GB</p> 
                                        <small class="txt-line-clamp1">規格：黑色</small> 
                                        <div class="products-quantity">
                                            <div class="d-flex number-spinner">
                                                <div class="input-group-btn data-dwn">
                                                      <button type="button" class="btn btn-default btn-outline-secondary" data-dir="dwn"><i class="fas fa-minus"></i></button>
                                                </div>
                                                <div><input type="number" class="form-control text-center product-quantity" value="1" min="0" max="3"  required="required"></div>
                                                <div class="input-group-btn data-up">
                                                      <button type="button" class="btn btn-default btn-outline-info" data-dir="up"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  
                            </div>                    
                            <div class=" col-3 col-lg-1 text-right">
                                  <button type="button" class="btn products-delbtn" value="store2">刪除</button>
                                <div class="store02-all price-asking" value="27320">$27,320 </div> 
                            </div>  
                        </div>                    
                    </li>   
                </ul>                                   
                </form>
            </ul>
            
        </div> 
        <div class="addheight container mb-5"></div>
        <div id="loginhtml"></div>
    </main>

    <footer class="shopping-cartfooter">
        <div class="shopping-coupon container">
            <a href="shopping-discount.html">
                <div class="flex-inline-between coupon-box">
                    <div><i class="material-icons offer"></i>下一步使用優惠券、折扣碼</div>
                </div>
            </a>
        </div>
        <div class="fixed-bottom container">        
            <div class="row subtotal-info">
                <div class="col-8 col-lg-9 text-right">
                    <small>小計</small><span class="price-subtotal" value="0">$ 0</span>
                    <p class="small text-secondary">未含運費</p>
                </div>
                <div class="col-4 col-lg-3 pl-0">
                     <button type="button" class="btn onlineshopping-btn mt-2 py-1 w-100 cart-next" onclick="location.href='shopping-discount.html'">下一步</button>
                </div>
            </div>
        </div>
    </footer>
    
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../js/vendor/bs4/js/jquery-3.2.1.slim.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->    
    <script src="../js/vendor/bs4/js/bootstrap.min.js"></script>

    <!-- owlcarousel JS -->
    <script src="../js/vendor/owlcarousel/vendors/jquery.min.js"></script>
    <script src="../js/vendor/owlcarousel/owlcarousel/owl.carousel.js"></script>
    <script src="../js/vendor/owlcarousel/vendors/highlight.js"></script>
    <script src="../js/vendor/owlcarousel/js/app.js"></script>   
    <script src="../js/vendor/jquery-editable-select-master/dist/jquery-editable-select.js"></script>

    <!-- vendor js -->
    <script src="../js/vendor/swiper/js/swiper.min.js"></script>
    <script src="../js/vendor/imgLiquid.js"></script>
    <script src="../js/masonry.pkgd.min.js"></script>

    <!-- custom js -->
    <script>    
        $("#loginhtml").load("../login.html");
        //Subtotal 
        var subtotal = parseInt($('.price-subtotal').attr('value'));
        $('input.store01-all, input.store02-all').click(function(){
            var sid = $(this).attr('class').split(/\s+/)[1];
            if($(this).is(":checked")){
                var parentsli = $(this).parents('li');
                subtotal += parseInt($(parentsli).find('.price-asking').attr('value'));
                $(parentsli).find('.price-asking').addClass('chk');
            }else{
                var parentsli = $(this).parents('li');
                subtotal -= parseInt($(parentsli).find('.price-asking').removeClass('chk').attr('value'));  
            }
            //parent checked
            if($('.'+sid+'.price-asking.chk').length == $('.'+sid+'.price-asking').length){
                $('#'+sid).attr('checked',true);
            };
            if($('.'+sid+'.price-asking.chk').length < $('.'+sid+'.price-asking').length){
                $('#'+sid).attr('checked',false);
            };
            sumtotal(subtotal);
        });

            var cktotal=0;
        //checked control
        $('.store-chk').on('click', function(){
            var chkid = $(this)[0].id;
            $this = this;  
            $.each($(this).parents('ul').find('input.'+chkid), function(i, item){
            $(item).prop('checked', $this.checked);
            });
            if(chkid=='checkedall'){
                subtotal =0;
                if($(this).is(':checked')){
                    subtotal += pask(chkid);
                    $('.price-asking').addClass('chk');
                }else{
                    subtotal = 0;
                    $('.price-asking').removeClass('chk');
                }
            }else{
                if($('#checkedall').is(':checked')){$('#checkedall').prop('checked', $this.checked);}
                if($(this).is(':checked')){
                    subtotal = subtotal + pask(chkid);
                    $('input.'+chkid).attr('disabled', true);
                }else{
                    subtotal = subtotal - pask(chkid);
                    $('input.'+chkid).attr('disabled', false);
                    //alert(subtotal+','+pask(chkid)+','+cktotal+','+pasktotal);
                    cktotal =0;
                }
            }
            sumtotal(subtotal);
        });     
        var pasktotal=0;
        //price-asking
        function pask(e){
            if(e=='checkedall'){
                // all check
                pasktotal=0;
                $('.price-asking').each(function() {
                    pasktotal += parseInt($(this).attr('value'));
                });
            }else{
                pasktotal=0;
                // check
                $('.'+e+'.price-asking.chk').each(function() {
                        cktotal += parseInt($(this).removeClass('chk').attr('value'));
                });
                // all check
                $('.'+e+'.price-asking').each(function() {
                        pasktotal += parseInt($(this).attr('value'));
                });
            };
            return pasktotal;
        }
        
        //total display
        function sumtotal(e){
            $('.price-subtotal').text('$'+formatPrice(e));
        }


        //footer coupon
        $('.shopping-coupon').addClass('fixed-bottom').slideDown(2000);


        //modify button control
        $('.modifybtn').on('click', function() {           
            var storebnval =  $(this).val();
            var btn_text = $(this).text();
            var modifybtnlen = $('.modifybtn').length;
            //edit branch store
            if (($(this).text().indexOf('編輯')>0)||(btn_text=='編輯')){
                $(this).text('完成');
                $('#'+storebnval+' .products-delbtn').show();
                $('#'+storebnval+' .price-asking').hide();
            };
            if (($(this).text().indexOf('完成')>0)||(btn_text=='完成')){
                if(storebnval != 'store0'){
                    $(this).text('編輯');
                    $('#'+storebnval+' .products-delbtn').hide();
                    $('#'+storebnval+' .price-asking').show();
                }
            };

            //edit all store
            if(storebnval == 'store0'){
                $(this).text('完成').val('ok');  
                $('.modifybtn').not($(this)).text('刪除全部');
                $('.products-delbtn').show();  
                $('.price-asking').hide(); 
            };
            //editok 
            if( (storebnval=='ok')){
                if(modifybtnlen=='1'){
                    $(this).hide();
                    $('.shopping-cartlist').html("<div class='d-flex flex-column justify-content-center align-items-center' style='height:300px'><p class='p-2 w-100 text-center'>喔喔！購物車內沒有商品</p><button type='button' class='btn onlineshopping-btn m-2 w-75 cart-next' onclick='location.href=index.html'>馬上去逛逛</button></div>");
                }else{
                    $(this).text('編輯全部').val('store0'); 
                    $('.modifybtn').not($(this)).text('編輯');
                    $('.products-delbtn').hide();  
                    $('.price-asking').show();   
                };
            };              
            //del
            if (btn_text=='刪除全部'){
                ($(this).parents('form').find('.price-asking.chk')).each(function() {
                    subtotal -= parseInt($(this).attr('value'));
                });
                sumtotal(subtotal);
                $(this).parents('form').remove();
            };
            $('.products-delbtn').on('click', function() { 
                if (subtotal>0){
                    subtotal -= parseInt($(this).parents('li').find('.price-asking').removeClass('chk').attr('value')); 
                    sumtotal(subtotal);
                }
                $(this).parents('li').remove();
            });

        });


        
        //Currency formatting
        function formatPrice(n) {
        var t = parseInt(n), i, r;
        for (t = t.toString().replace(/^(\d*)$/, "$1."), t = (t + "00").replace(/(\d*\.\d\d)\d*/, "$1"), t = t.replace(".", ","), i = /(\d)(\d{3},)/; i.test(t); )
            t = t.replace(i, "$1,$2");
        return t = t.replace(/,(\d\d)$/, ".$1"), r = t.split("."), r[1] == "00" && (t = r[0]), t
        }

    </script>
    <script src="../js/index.js"></script>
</body>

</html>