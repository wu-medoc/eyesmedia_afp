<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1, user-scalable=no">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../js/vendor/bs4/css/bootstrap.min.css">
    <!-- vendor css -->
    <link rel="stylesheet" href="../js/vendor/jquery-editable-select-master/dist/jquery-editable-select.min.css">
    <link rel="stylesheet" href="../js/vendor/swiper/css/swiper.min.css">
    <!-- fontawesome css -->
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/fontawesome.css">
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/brands.css">
    <link rel="stylesheet" href="../js/vendor/fontawesome/css/solid.css">
    <!-- custom css -->
    <link rel="stylesheet" href="../dist/style/css.min.css">
    <link rel="stylesheet" href="../dist/style/global.min.css">
    <link rel="stylesheet" href="../dist/style/index.min.css">
    <link rel="stylesheet" href="../dist/style/shopping-index.min.css">
    <link rel="stylesheet" href="../dist/style/animate.min.css">
    <title>Mobii!</title>
</head>

<body>
    <div class="wrap container">
        <header>
            <div class="header-secondary container linebt-row">
                <div class="index-flex justify-content-between">
                    <div class="item two">
                        <div class="close-btn" onclick="history.back();" data-toggle="tooltip" data-placement="bottom" title="回上一頁">
                            <i class="material-icons">&#xe314;</i>
                        </div>
                    </div>
                    <div class="item three text-center">
                        <div class="title-name">確認訂單</div>
                    </div>
                    <div class="item two text-right">
                        <div class="close-btn"></div>
                    </div>
                </div>
            </div>
        </header>

        <form id="ngForm">   
            <main class="orderbox">     
                <div class="order-step-box">
                    <ol class="step-list">
                        <li class="active">1</li>
                        <li class="">2</li>
                        <li class="">3</li>
                    </ol>
                    <ol class="step-txt">
                        <li>確認訂單</li>
                        <li>付款</li>
                        <li>訂購完成</li>
                    </ol>
                </div>
                <!-- 訂購人資料 -->
                <div class="order-box">
                    <div class="order-title">
                        訂購人資料
                    </div>
                    <ul class="order-list">
                        <li class="index-flex">
                            <div class="item one">姓名</div>
                            <div class="item three">
                                <input type="text" class="form-control" id="validationDefault01" placeholder="請輸入" required>
                            </div>
                        </li>
                        <li class="index-flex">
                            <div class="item one">手機號碼</div>
                            <div class="item three">
                                <input type="tel" class="form-control" id="validationDefault02" placeholder="請輸入" required>
                            </div>
                        </li>
                        <li class="index-flex">
                            <div class="item one">Email</div>
                            <div class="item three">
                                <input type="email" class="form-control" id="validationDefault03" placeholder="請輸入" required>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- 訂單詳情 -->
                <div class="order-title">
                    訂單詳情
                </div>
                <div class="order-box store" id="store3">
                    <div class="order-subtitle">
                        <img src="../img/share/fa-store.png" class="h20 mx-1">艾斯移動
                    </div>
                    <ul class="order-shop-list">
                        <li>
                            <div class="item rwdimgbox-80">
                                <div style="background-image: url('https://picsum.photos/300/300/?random=1');" class="rwdimg"></div>
                            </div>
                            <div class="item item-txt">
                                <p>高雄捷運一日 QR CODE 搭乘券</p>
                                <p>規格：單一規格</p>
                                <p class="order-price auto-top store3-products001-price" value="120">$120</p>
                            </div>
                            <div class="item item-num order-quantity" value="2">x1</div>
                        </li>
                    </ul>
                    <div class="order-method-box">
                        <ul class="method-list">
                            <li class="index-flex">
                                <div class="item three">此賣場訂單金額 (<span class="store3-products-num">1</span>件商品)</div>
                                <div class="item one item-total-price text-right store3-subtotal" value="120">
                                    $120
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="border-t5 w-100"></div>
                <div class="order-title">
                    付款詳情
                </div>
                <div class="order-box">
                    <div class="order-method-box">
                        <ul class="method-list">
                            <li class="index-flex" onclick="callLayer('.shopping-discount')">
                                <div class="item three"><i class="material-icons reverse">&#xE54E;</i>使用優惠券、折扣碼</div>
                                <div class="item one discount-price text-right"><span class="store1-discount-price" value="0">-$0</span><i class="material-icons">&#xe315;</i></div>
                            </li>
                            <li class="index-flex invobox">
                                <div class="item d-flex d-inline"><div class="invo-box"><i class="material-icons">&#xE8B0;</i></div>電子發票/收據</div>
                                <div class="item text-right invoice-txt"><span class="text-muted">開立收據</span></div>
                            </li>
                        </ul>
                    </div>
                    <div class="total-price-box">
                        <ul>
                            <li class="index-flex">
                                <div class="item">商品總金額</div>
                                <div class="item text-right order-subtotal" value="120">$120</div>
                            </li>
                            <li class="index-flex">
                                <div class="item">運費總金額</div>
                                <div class="item text-right order-delivery" value="0">$0</div>
                            </li>
                            <li class="index-flex">
                                <div class="item">優惠折抵</div>
                                <div class="item text-right order-discount" value="0">-$0</div>
                            </li>
                            <li class="index-flex py-0">
                                <div class="item two left-line">優惠券 AFP20200111004 </div>
                                <div class="item one text-right sub-discount" value="-0">(-$0) </div>
                            </li>
                            <li class="index-flex py-0">
                                <div class="item two left-line">春節優惠折抵 </div>
                                <div class="item ont text-right sub-discount" value="-0">(-$0) </div>
                            </li>
                            <li class="total-pay index-flex">
                                <div class="item">付款總金額</div>
                                <div class="item text-right order-sumtotal" value="120">$120</div>
                            </li>
                        </ul>
                    </div>
                </div>          
            </main>
            <footer class="shopping-cartfooter order-go-pay">
                <div class="fixed-bottom container fixed-shadow">        
                    <div class="row subtotal-info">
                        <div class="col-8 col-lg-9 text-right">
                            <small>小計</small><span class="price-subtotal" value="120">$120</span>
                            <p class="mobi">此筆訂單可賺<span class="order-mobi" value="2">2</span>魔幣</p>
                        </div>
                        <div class="col-4 col-lg-3 pl-0">
                            <button type="button" class="btn index-btn mt-2 py-1 w-100 cart-next msg-open" value="msg-shoppingorder" data-toggle="modal" data-target="#messageModal" onclick="checkform()">去結帳</button>
                        </div>
                    </div>
                </div>
            </footer>
        </form> 

        <div class="multilayer">
            <!-- 選擇優惠券 -->
            <div class="shopping-discount">   
                <header>
                    <div class="header-secondary container linebt-row">
                        <div class="index-flex justify-content-between">
                            <div class="item one">
                                <div class="close-btn" onclick="backLayer()">
                                    <i class="material-icons">&#xe314;</i>
                                </div>
                            </div>
                            <div class="item three text-center">
                                <div class="title-name">選擇優惠券或輸入折扣碼</div>
                            </div>
                            <div class="item one text-right">
                                <div class="close-btn"></div>
                            </div>
                        </div>
                    </div>
                </header>
                <div>
                    <div class="text-center div-switch d-none">
                        <p class="canuse-discount-txt font-bold">可使用的優惠券
                        <input type="reset" value="重設" class="float-right btn"></p>
                        <!-- 可使用的優惠券 -->   
                        <form id="store3">
                            <div class="can-use-discount-list">
                                <p class="can-use-title"><span>艾斯移動</span> 可選擇<span>一</span>張</p>
                                <ul>
                                    <li class="checkedli">
                                        <div class="item rwdimgbox-80">
                                            <div style="background-image: url('https://picsum.photos/300/300/?random=4');" class="rwdimg"></div>
                                        </div>
                                        <div class="item discount-text item-middle">
                                            <p>艾斯移動</p>
                                            <p>9折 折扣券</p>
                                            <p>2019/11/15 ~ 2019/12/31</p>
                                        </div>
                                        <label class="radio-box">
                                            <div class="item">
                                                <input type="radio" name="radio3" id="discount004" class="store3">
                                                <span class="checkmark"></span>
                                            </div>
                                        </label>
                                    </li>
                                </ul>
                            </div>
                        </form>              
                        <form id="store1">
                            <div class="can-use-discount-list">
                                <p class="can-use-title"><span>Mobii商城</span> 可選擇<span>二</span>張</p>
                                <ul>
                                    <li class="checkedli">
                                        <div class="item rwdimgbox-80">
                                            <div style="background-image: url('../img/share/mlogo.png');" class="rwdimg"></div>
                                        </div>
                                        <div class="item discount-text item-middle">
                                            <p>Mobii商城</p>
                                            <p>醫療口罩兌換券</p>
                                            <p>2019/11/15 ~ 2019/12/31</p>
                                        </div>
                                        <label class="radio-box">
                                            <div class="item">
                                                <input type="radio" name="radio" id="discount001" class="store1">
                                                <span class="checkmark"></span>
                                            </div>
                                        </label>
                                    </li>
                                    <li class="checkedli">
                                        <div class="item rwdimgbox-80">
                                            <div style="background-image: url('../img/share/mlogo.png');" class="rwdimg"></div>
                                        </div>
                                        <div class="item discount-text item-middle">
                                            <p>Mobii商城</p>
                                            <p>8折 折扣券</p>
                                            <p>2019/11/15 ~ 2019/12/31</p>
                                        </div>
                                        <label class="radio-box">
                                            <div class="item">
                                                <input type="radio" name="radio" id="discount002" class="store1">
                                                <span class="checkmark"></span>
                                            </div>
                                        </label>
                                    </li>
                                </ul>
                            </div>
                        </form>    
                        <!-- 本次結帳無法用的優惠券 -->
                        <p class="canuse-discount-txt font-bold mt-0">本次結帳無法用的優惠券</p>
                        <div class="can-use-discount-list">
                            <ul>
                                <li class="checkedli">
                                    <div class="item rwdimgbox-80">
                                        <div style="background-image: url('https://picsum.photos/300/300/?random=4');" class="rwdimg"></div>
                                    </div>
                                    <div class="item item-middle">
                                        <p>昇恆昌</p>
                                        <p>滿萬送千 折價券</p>
                                        <p class="can-use-date">使用期限 2019/11/15 ~ 2019/12/31</p>
                                    </div>
                                    <div class="item item-see-more">
                                        <a href="store-info.html">
                                            去逛逛<i class="material-icons">&#xe315;</i>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <!-- total price -->
                        <div class="total-price-box">
                            <div class="total-header">
                                <div class="store1 discount001" style="display:none;">
                                    <div class="item-group small">
                                        <div class="item"><p class="txt-line-clamp1">昇恆昌 9折 折扣券</p></div>
                                        <div class="item discount-price" value="88">88 元</div>
                                    </div>
                                </div>
                                <div class="store1 discount002" style="display:none;">
                                    <div class="item-group small">
                                        <div class="item"><p class="txt-line-clamp1">昇恆昌 8折 折扣券</p></div>
                                        <div class="item discount-price" value="288">288 元</div>
                                    </div>
                                </div>
                                <div class="store2 discount003" style="display:none;">
                                    <div class="item-group small">
                                        <div class="item"><p class="txt-line-clamp1">新光三越 9折 折扣券</p></div>
                                        <div class="item discount-price" value="188">188 元</div>
                                    </div>
                                </div>
                                <div class="store3 discount004" style="display:none;">
                                    <div class="item-group small">
                                        <div class="item"><p class="txt-line-clamp1">艾斯移動 9折 折扣券</p></div>
                                        <div class="item discount-price" value="12">12 元</div>
                                    </div>
                                </div>
                            </div>
                            <div class="total-body">
                                <div class="item-group">
                                    <div class="item">總共優惠金額</div>
                                    <div class="item price-dissubtotal" value="0">0 元</div>
                                </div>
                            </div>
                            <div class="total-footer">
                                <div class="item-group">
                                    <div class="item">
                                        <button type="button" class="cancel-btn" onclick="backLayer()">取消</button>
                                    </div>
                                    <div class="item">
                                        <button type="button" class="submit-btn" onclick="backLayer()">確定</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="no-order div-switch d-block">
                        <img src="../img/shopping/nodiscount.png" alt="">
                        <p class="">咦？目前還沒有優惠券喔...</p>
                        <button type="button" class="btn gray-btn mt-2" onclick="div_switch()">顯示優惠券狀態</button>
                    </div>
                </div>  
            </div>
            <!-- 發票選取 -->
            <div class="shopping-invoice">
                <header>
                    <div class="header-secondary container linebt-row">
                        <div class="index-flex justify-content-between">
                            <div class="item two">
                                <div class="close-btn" onclick="backLayer();" data-toggle="tooltip" data-placement="bottom" title="回上一頁">
                                    <i class="material-icons">&#xe314;</i>
                                </div>
                            </div>
                            <div class="item three text-center">
                                <div class="title-name">電子發票</div>
                            </div>
                            <div class="item two text-right">
                                <div class="close-btn"></div>
                            </div>
                        </div>
                    </div>
                </header>
                <form>
                    <main>
                        <div class="electronic-choice-list">
                            <ul class="invoice">
                                <li>
                                    <div class="item">
                                        <label class="radio-box">發票捐贈
                                            <input type="radio" name="radio">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="d-flex align-items-center auto-left">
                                        <div class="item">
                                            <input type="text" placeholder="請輸入愛心碼" class="heartcode">
                                        </div>
                                        <div class="item search-txt pl-2" onclick="callsortLayer('.hcode');">
                                            查詢<i class="material-icons">&#xe315;</i>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <label class="radio-box">會員載具
                                            <input type="radio" name="radio">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="item auto-left"><small>電子發票若中獎將寄送至會員預設地址</small></div>
                                </li>
                                <li>
                                    <div class="item">
                                        <label class="radio-box">手機條碼載具
                                            <input type="radio" name="radio">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="item auto-left">
                                        <input type="text" placeholder="請填寫手機條碼">
                                    </div>
                                </li>
                                <li>
                                    <div class="item item-self">
                                        <label class="radio-box">三聯式發票
                                            <input type="radio" name="radio">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="item-group auto-left">
                                        <input type="text" placeholder="請輸入發票抬頭名稱">
                                        <input type="text" placeholder="請輸入統一編號">
                                    </div>
                                </li>
                            </ul>
                            <div class="addheight"></div>
                        </div>      
                    </main>        
                    <footer class="success-mode container">
                        <button type="button" class="btn-ok" onclick="backLayer();">確認</button>
                    </footer>     
                </form>
            </div>
        </div>
                
        
        <div class="sortlayer">
            <!-- 愛心碼選單 -->
            <div class="hcode">
                <div id="open-pagebox">
                    <div class="open-page-title flex-inline-between">
                        <div class="title-icon">
                            <button class="btn" onclick="backsortLayer();">
                                <i class="material-icons">&#xe314;</i>
                            </button>
                        </div>
                        <div class="title-txt">
                            查詢愛心碼
                        </div>
                        <div class="title-txt">
                        </div>
                    </div>
                    <ul class="open-page-ul" id="queryhcode" onclick="backsortLayer();">
                        <li class="flex-inline-between" value="119">
                            <div class="item">
                                社團法人台灣流浪動物希望協會
                            </div>
                            <div class="item">
                                119
                            </div>    
                        </li>
                        <li class="flex-inline-between" value="0095">
                            <div class="item">
                                財團法人法鼓山文教基金會
                            </div>
                            <div class="item">
                                0095
                            </div>    
                        </li>
                        <li class="flex-inline-between" value="172">
                            <div class="item">
                                流浪貓保護協會
                            </div>
                            <div class="item">
                                172
                            </div>    
                        </li>
                        <li class="flex-inline-between" value="0528">
                            <div class="item">
                                中華民國流浪動物花園協會
                            </div>
                            <div class="item">
                                0528
                            </div>    
                        </li>
                        <li class="flex-inline-between" value="529">
                            <div class="item">
                                社團法人高雄市關懷流浪動物協會
                            </div>
                            <div class="item">
                                529
                            </div>    
                        </li>
                    </ul>
                </div>
            </div>

        </div> 
    </div>

    <!-- message Modal -->
    <div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header" data-dismiss="modal" aria-label="Close">
            </div>
            <button type="button" class="close text-right" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;&ensp;</span>
            </button>
            <div class="modal-body p-0">
                <div id="msg-shoppingorder">
                    <div class="p-2 mb-4">
                        請選擇訂購人資料、發票樣式、優惠券
                    </div>
                    <div class="text-center bg-light border-t py-2">
                        <button type="button" class="btn btn-login font-bold w-100 masklayer-close"  data-dismiss="modal" aria-label="Close">
                            確定
                        </button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../js/vendor/bs4/js/jquery-3.2.1.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->    
    <script src="../js/vendor/bs4/js/popper.min.js"></script>
    <script src="../js/vendor/bs4/js/bootstrap.min.js"></script>
    
    
    <script src="../js/vendor/jquery-editable-select-master/dist/jquery-editable-select.js"></script>

    <!-- vendor js -->
    <script src="../js/vendor/swiper/js/swiper.min.js"></script>
    <script src="../js/vendor/imgLiquid.js"></script>
    
    <!-- custom js -->
    <script src="../js/animateCss.js"></script>
    <script>  
        //discount
        var distotal=parseInt($('.price-dissubtotal').attr('value'));
        $('.checkedli').on('click', function() { 
            var ckid=$(this).children().find('input').attr('id'); 
            var ckstroe=$(this).children().find('input').attr('class'); 
            $('input#'+ckid).prop('checked', true);
            $('input[type=radio]').each(function() {
                var id=$(this).attr('id');
                ($(this).is(':checked')) ? $('.'+id).attr("style","display:block") : $('.'+id).attr("style","display:none");
            });
            distotal=0;
            $('.total-header>div').each(function() {
                if (($(this).attr("style"))=="display:block")
                    distotal += parseInt($(this).find('.discount-price').attr('value'));
            });
            dissumtotal(distotal); 
        });
        //reset for discount
        $('input[type=reset]').on('click', function() { 
            $('form').each(function() {
                $(this)[0].reset();
            });
            $('.total-header>div').attr("style","display:none");
            dissumtotal(0);
        });
        //total display for discount
        function dissumtotal(e){
            $('.price-dissubtotal').text('$'+formatPrice(e)+'元');
        }

        //order sumtotal
        var sumtotal = 0;
        $(document).ready(function(){
            sumtotal = parseInt($('.order-subtotal').attr('value'))
                     + parseInt($('.order-delivery').attr('value'))
                     + parseInt($('.order-discount').attr('value'));
            $('.order-sumtotal').text('$'+formatPrice(sumtotal)).attr('value',sumtotal);      
            $('.order-mobi').text(formatPrice(sumtotal*0.02)).attr('value',sumtotal);
        });


        //Currency formatting
        function formatPrice(n) {
        var t = parseInt(n), i, r;
        for (t = t.toString().replace(/^(\d*)$/, "$1."), t = (t + "00").replace(/(\d*\.\d\d)\d*/, "$1"), t = t.replace(".", ","), i = /(\d)(\d{3},)/; i.test(t); )
            t = t.replace(i, "$1,$2");
        return t = t.replace(/,(\d\d)$/, ".$1"), r = t.split("."), r[1] == "00" && (t = r[0]), t
        };

        //invoice choosen
        $('#queryhcode li').on('click',function(){
            hcode=$(this).attr('value');
            $('input.heartcode').attr('value',hcode);
        });
        $('.invoice>li').on('click',function(){
            $(this).find('input').prop('checked',true);
        });
        
        /** 避免輸入鍵盤擋到輸入框 */
        $("input").focus(function(e){ 
            const target = $('input').index(e.currentTarget);
            document.body.scrollTop = ($('input').eq(target)[0].offsetTop - 50); 
        });

        function checkform(){
            if($('#validationDefault01').val()!="" && $('#validationDefault02').val()!="" && $('#validationDefault03').val()!="")
            location.href="shopping-paymentTicket.html";
        }

    </script>
    <script src="../js/index.js"></script>
</body>

</html>